# 作業履歴 2025-04-24

## 概要

2025-04-24の作業内容をまとめています。このジャーナルでは、システムの現状分析として「アーキテクチャ概要」と「ユースケース」の2つの重要なドキュメントを作成しました。これらのドキュメントは、Baukis-Kaiシステムの構造、機能、および利用パターンを包括的に説明し、開発チームや新しいメンバーがシステムを理解するための基盤となります。

## コミット: 49163f7 - システムドキュメントの作成

### 概要
システムの現状分析として、アーキテクチャとユースケースに関する詳細なドキュメントを作成しました。これらのドキュメントは、システムの全体像を把握し、今後の開発や保守作業の指針となることを目的としています。

### 技術的詳細
- **アーキテクチャ概要**: システムの構造、層、コンポーネント間の関係を詳細に説明
  - システム概要と主要機能
  - 3つの主要サブシステム（スタッフ、顧客、管理者インターフェース）
  - アプリケーション層構造（MVC拡張）
  - 名前空間とインターフェース構造
  - データモデルとその関連
  - ビジネスフロー
  - 認証・認可システム
  - 配置アーキテクチャ
  - 開発ガイドライン

- **ユースケース**: システムの利用パターンを詳細に説明
  - アクター（職員、顧客、管理者）の定義
  - 各アクターのユースケース詳細
  - ユースケース関連図

### メッセージ

```
docs:現状分析
```

### 変更されたファイル

- A	"docs/\343\202\242\343\203\274\343\202\255\343\203\206\343\202\257\343\203\201\343\203\243\346\246\202\350\246\201.md"
- A	"docs/\343\203\246\343\203\274\343\202\271\343\202\261\343\203\274\343\202\271.md"

### 変更内容

```diff
commit 49163f777eaed28780efdfe817f6749908e196cd
Author: k2works <kakimomokuri@gmail.com>
Date:   Thu Apr 24 18:47:02 2025 +0900

    docs:現状分析

diff --git "a/docs/\343\202\242\343\203\274\343\202\255\343\203\206\343\202\257\343\203\201\343\203\243\346\246\202\350\246\201.md" "b/docs/\343\202\242\343\203\274\343\202\255\343\203\206\343\202\257\343\203\201\343\203\243\346\246\202\350\246\201.md"
new file mode 100644
index 0000000..d91f3e0
--- /dev/null
+++ "b/docs/\343\202\242\343\203\274\343\202\255\343\203\206\343\202\257\343\203\201\343\203\243\346\246\202\350\246\201.md"
@@ -0,0 +1,412 @@
+# Baukis-Kai システムアーキテクチャ概要
+
+## 1. システム概要
+
+Baukis-Kaiは顧客管理システムで、主に以下の機能を提供します:
+
+- スタッフによる顧客情報管理
+- 顧客のプログラム予約および参加管理
+- 顧客とスタッフ間のメッセージングシステム
+- 管理者によるスタッフ管理とシステム設定
+
+## 2. システム構成
+
+システムは以下の3つの主要なサブシステムに分かれています:
+
+1. **スタッフインターフェース**: スタッフが顧客情報やプログラムを管理するためのインターフェース
+2. **顧客インターフェース**: 顧客が自身の情報、予約、メッセージを管理するためのインターフェース
+3. **管理者インターフェース**: システム全体とスタッフを管理するための管理者用インターフェース
+
+## 3. アプリケーション層構造
+
+Railsアプリケーションの拡張版MVCアーキテクチャに基づいており、以下の層に分かれています:
+
+```plantuml
+@startuml
+package "Presentation Layer" {
+  [Views]
+  [Controllers]
+  [Presenters]
+  [Forms]
+}
+
+package "Domain Layer" {
+  [Models]
+  [Services]
+}
+
+package "Shared Components" {
+  [Concerns]
+  [Validators]
+  [Helpers]
+}
+
+[Controllers] --> [Forms]
+[Controllers] --> [Services]
+[Forms] --> [Models]
+[Services] --> [Models]
+[Views] --> [Presenters]
+[Presenters] --> [Models]
+[Models] --> [Concerns]
+@enduml
+```
+
+## 4. 名前空間とインターフェース構造
+
+アプリケーションは名前空間を使用して3つのインターフェースを分離しています:
+
+```plantuml
+@startuml
+node "Baukis-Kai Application" {
+  [ApplicationController] --> [Staff::BaseController]
+  [ApplicationController] --> [Admin::BaseController]
+  [ApplicationController] --> [Customer::BaseController]
+
+  package "Staff Interface" {
+    [Staff::BaseController] --> [Staff Controllers]
+    [Staff Controllers] --> [Staff Services]
+    [Staff Controllers] --> [Staff Presenters]
+    [Staff Controllers] --> [Staff Forms]
+  }
+
+  package "Admin Interface" {
+    [Admin::BaseController] --> [Admin Controllers]
+    [Admin Controllers] --> [Admin Services]
+    [Admin Controllers] --> [Admin Presenters]
+    [Admin Controllers] --> [Admin Forms]
+  }
+
+  package "Customer Interface" {
+    [Customer::BaseController] --> [Customer Controllers]
+    [Customer Controllers] --> [Customer Services]
+    [Customer Controllers] --> [Customer Presenters]
+    [Customer Controllers] --> [Customer Forms]
+  }
+}
+@enduml
+```
+
+## 5. 主要なデータモデル
+
+システムの主要なエンティティとその関係は以下の通りです:
+
+```plantuml
+@startuml
+entity StaffMember {
+  * id: integer
+  * email: string
+  * family_name: string
+  * given_name: string
+  * family_name_kana: string
+  * given_name_kana: string
+  * hashed_password: string
+  * start_date: date
+  * end_date: date
+  * suspended: boolean
+}
+
+entity Administrator {
+  * id: integer
+  * email: string
+  * hashed_password: string
+  * suspended: boolean
+}
+
+entity Customer {
+  * id: integer
+  * email: string
+  * family_name: string
+  * given_name: string
+  * family_name_kana: string
+  * given_name_kana: string
+  * gender: string
+  * birthday: date
+  * hashed_password: string
+}
+
+entity HomeAddress {
+  * id: integer
+  * customer_id: integer
+  * postal_code: string
+  * prefecture: string
+  * city: string
+  * address1: string
+  * address2: string
+}
+
+entity WorkAddress {
+  * id: integer
+  * customer_id: integer
+  * postal_code: string
+  * prefecture: string
+  * city: string
+  * address1: string
+  * address2: string
+  * company_name: string
+  * division_name: string
+}
+
+entity Phone {
+  * id: integer
+  * customer_id: integer
+  * address_id: integer
+  * number: string
+  * number_for_index: string
+  * primary: boolean
+}
+
+entity Program {
+  * id: integer
+  * registrant_id: integer
+  * title: string
+  * description: text
+  * application_start_time: datetime
+  * application_end_time: datetime
+  * min_number_of_participants: integer
+  * max_number_of_participants: integer
+}
+
+entity Entry {
+  * id: integer
+  * program_id: integer
+  * customer_id: integer
+  * approved: boolean
+  * canceled: boolean
+}
+
+entity Message {
+  * id: integer
+  * type: string
+  * customer_id: integer
+  * staff_member_id: integer
+  * subject: string
+  * body: text
+  * parent_id: integer
+  * discarded: boolean
+  * deleted: boolean
+}
+
+entity Tag {
+  * id: integer
+  * value: string
+}
+
+entity StaffEvent {
+  * id: integer
+  * staff_member_id: integer
+  * type: string
+  * occurred_at: datetime
+}
+
+Customer ||--o{ HomeAddress
+Customer ||--o{ WorkAddress
+Customer ||--o{ Phone
+Customer ||--o{ Entry
+Customer ||--o{ Message
+
+StaffMember ||--o{ StaffEvent
+StaffMember ||--o{ Program
+StaffMember ||--o{ Message
+
+Program ||--o{ Entry
+
+Message ||--o{ Message : replies
+Message }o--o{ Tag : tags
+@enduml
+```
+
+## 6. 主要なビジネスフロー
+
+### 6.1 顧客管理フロー
+
+```plantuml
+@startuml
+actor "スタッフ" as Staff
+participant "StaffController" as SC
+participant "CustomerService" as CS
+participant "Customer" as C
+database "Database" as DB
+
+Staff -> SC: 顧客情報登録/編集
+SC -> CS: 顧客情報処理
+CS -> C: 顧客モデル操作
+C -> DB: 保存
+DB --> Staff: 結果表示
+@enduml
+```
+
+### 6.2 プログラム予約フロー
+
+```plantuml
+@startuml
+actor "顧客" as Customer
+participant "CustomerController" as CC
+participant "EntryService" as ES
+participant "Entry" as E
+participant "Program" as P
+database "Database" as DB
+
+Customer -> CC: プログラム予約
+CC -> ES: 予約処理
+ES -> E: エントリー作成
+E -> P: プログラム参照
+E -> DB: 保存
+DB --> Customer: 結果表示
+@enduml
+```
+
+### 6.3 メッセージングフロー
+
+```plantuml
+@startuml
+actor "顧客" as Customer
+actor "スタッフ" as Staff
+participant "MessageController" as MC
+participant "MessageService" as MS
+participant "Message" as M
+database "Database" as DB
+
+Customer -> MC: メッセージ送信
+MC -> MS: メッセージ処理
+MS -> M: メッセージ作成
+M -> DB: 保存
+
+Staff -> MC: メッセージ確認
+MC -> DB: メッセージ取得
+DB --> Staff: メッセージ表示
+
+Staff -> MC: 返信送信
+MC -> MS: 返信処理
+MS -> M: 返信作成
+M -> DB: 保存
+DB --> Customer: 通知
+@enduml
+```
+
+## 7. アプリケーションの特徴的なパターン
+
+### 7.1 Presenterパターン
+
+モデルのデータを表示用に整形するPresenterパターンを採用しています。
+
+```plantuml
+@startuml
+class "ModelPresenter" {
+  +initialize(object, view_context)
+  +created_at
+  +updated_at
+}
+
+class "FormPresenter" {
+  +initialize(form_builder, view_context)
+  +text_field_block(name, label_text, options)
+  +password_field_block(name, label_text, options)
+  +date_field_block(name, label_text, options)
+  +error_messages_for(name)
+}
+
+class "ConfirmingFormPresenter" {
+  +text_field_block(name, label_text, options)
+  +password_field_block(name, label_text, options)
+  +date_field_block(name, label_text, options)
+}
+
+ModelPresenter <|-- "CustomerPresenter"
+FormPresenter <|-- "StaffFormPresenter"
+FormPresenter <|-- "CustomerFormPresenter" 
+FormPresenter <|-- "ProgramFormPresenter"
+ConfirmingFormPresenter <|-- "ConfirmingUserFormPresenter"
+@enduml
+```
+
+### 7.2 Service層パターン
+
+複雑なビジネスロジックをカプセル化するService層を導入しています。
+
+```plantuml
+@startuml
+class "StaffService" {
+  +authenticate(email, password)
+  +update_account(staff_member, params)
+}
+
+class "CustomerService" {
+  +create_customer(params)
+  +update_customer(customer, params)
+}
+
+class "MessageService" {
+  +create_message(sender, recipient, params)
+  +mark_as_read(message)
+  +discard_message(message)
+}
+
+class "ProgramService" {
+  +create_program(staff_member, params)
+  +cancel_program(program)
+}
+@enduml
+```
+
+## 8. 認証・認可システム
+
+システムは独自の認証システムを実装しており、それぞれのインターフェースごとに分離されています。
+
+```plantuml
+@startuml
+actor Staff
+actor Customer
+actor Administrator
+
+Staff --> [Staff::SessionsController]
+Customer --> [Customer::SessionsController]
+Administrator --> [Admin::SessionsController]
+
+[Staff::SessionsController] --> [StaffMember]: authenticate
+[Customer::SessionsController] --> [Customer]: authenticate
+[Admin::SessionsController] --> [Administrator]: authenticate
+
+[StaffMember] --> [Staff::BaseController]: current_staff_member
+[Customer] --> [Customer::BaseController]: current_customer
+[Administrator] --> [Admin::BaseController]: current_administrator
+@enduml
+```
+
+## 9. 配置アーキテクチャ
+
+Dockerを使用した開発・本番環境の構成:
+
+```plantuml
+@startuml
+node "Docker Environment" {
+  [Nginx] --> [Rails Application]
+  [Rails Application] --> [PostgreSQL]
+}
+
+[Developer] --> [Docker Environment]
+[User] --> [Production Server]
+@enduml
+```
+
+## 10. 開発ガイドライン
+
+1. **名前空間の分離**: 各インターフェース（スタッフ、顧客、管理者）のコードは名前空間で明確に分離する
+2. **Presenterの活用**: 表示ロジックはPresenterに集約する
+3. **サービスクラスの使用**: 複雑なビジネスロジックはServiceクラスに実装する
+4. **Concernの活用**: 共通コードはConcernとして実装し、再利用性を高める
+5. **独自バリデータ**: 特殊な検証ロジックは独自のバリデータとして実装する
+
+## 11. テスト戦略
+
+- モデルテスト: RSpecを使用したモデルの単体テスト
+- コントローラテスト: コントローラの機能テスト
+- システムテスト: Capybaraを使用したE2Eテスト
+- ファクトリ: FactoryBotを使用したテストデータの生成
+
+## 12. 将来の拡張性
+
+システムは以下のような拡張を考慮して設計されています:
+
+1. APIサポート: 将来のモバイルアプリケーション対応
+2. 多言語対応: 国際化対応の拡張
+3. 高度な分析・レポーティング機能の追加
diff --git "a/docs/\343\203\246\343\203\274\343\202\271\343\202\261\343\203\274\343\202\271.md" "b/docs/\343\203\246\343\203\274\343\202\271\343\202\261\343\203\274\343\202\271.md"
new file mode 100644
index 0000000..aeee4d3
--- /dev/null
+++ "b/docs/\343\203\246\343\203\274\343\202\271\343\202\261\343\203\274\343\202\271.md"
@@ -0,0 +1,502 @@
+# Baukis-Kai システムユースケース
+
+## 1. 概要
+
+このドキュメントはBaukis-Kaiシステムの主要なユースケースを定義します。システムは主に3つのユーザータイプ（スタッフ、顧客、管理者）向けの機能を提供しています。
+
+## 2. アクター定義
+
+システムには以下の主要なアクターが存在します：
+
+1. **スタッフ**: 顧客情報管理、プログラム管理、顧客とのコミュニケーションを担当する組織の従業員
+2. **顧客**: サービスを利用する個人またはグループ
+3. **管理者**: システム全体とスタッフアカウントを管理する権限を持つユーザー
+
+## 3. スタッフのユースケース
+
+### 3.1. アカウント管理
+
+| ユースケースID | S-001 |
+| ------------- | ----- |
+| ユースケース名 | スタッフログイン |
+| アクター | スタッフ |
+| 説明 | スタッフがシステムにログインする |
+| 事前条件 | スタッフアカウントが作成されている |
+| 基本フロー | 1. スタッフがログインページにアクセス<br>2. メールアドレスとパスワードを入力<br>3. 認証情報を検証<br>4. ダッシュボードにリダイレクト |
+| 代替フロー | - 認証失敗: エラーメッセージを表示<br>- アカウント停止中: アクセス拒否メッセージを表示 |
+| 事後条件 | スタッフがシステムにログインした状態になる |
+
+| ユースケースID | S-002 |
+| ------------- | ----- |
+| ユースケース名 | スタッフログアウト |
+| アクター | スタッフ |
+| 説明 | スタッフがシステムからログアウトする |
+| 事前条件 | スタッフがログイン済み |
+| 基本フロー | 1. スタッフがログアウトボタンをクリック<br>2. セッションを終了<br>3. ログインページにリダイレクト |
+| 代替フロー | なし |
+| 事後条件 | スタッフがログアウト状態になる |
+
+| ユースケースID | S-003 |
+| ------------- | ----- |
+| ユースケース名 | スタッフアカウント情報更新 |
+| アクター | スタッフ |
+| 説明 | スタッフが自身のアカウント情報を更新する |
+| 事前条件 | スタッフがログイン済み |
+| 基本フロー | 1. スタッフがアカウント設定ページにアクセス<br>2. 情報を編集<br>3. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | スタッフの情報が更新される |
+
+### 3.2. 顧客管理
+
+| ユースケースID | S-004 |
+| ------------- | ----- |
+| ユースケース名 | 顧客情報登録 |
+| アクター | スタッフ |
+| 説明 | スタッフが新規顧客情報を登録する |
+| 事前条件 | スタッフがログイン済み |
+| 基本フロー | 1. 顧客登録フォームにアクセス<br>2. 顧客の基本情報を入力<br>3. 住所情報を入力（自宅/職場）<br>4. 電話番号情報を入力<br>5. フォームを送信<br>6. システムがデータを検証<br>7. 顧客情報を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | 新規顧客情報がシステムに登録される |
+
+| ユースケースID | S-005 |
+| ------------- | ----- |
+| ユースケース名 | 顧客情報検索 |
+| アクター | スタッフ |
+| 説明 | スタッフが顧客情報を検索する |
+| 事前条件 | スタッフがログイン済み |
+| 基本フロー | 1. 顧客検索フォームにアクセス<br>2. 検索条件（名前、メールアドレス、電話番号など）を入力<br>3. 検索を実行<br>4. 検索結果を表示 |
+| 代替フロー | - 検索結果なし: 該当する顧客がない旨のメッセージを表示 |
+| 事後条件 | 検索条件に合致する顧客情報が表示される |
+
+| ユースケースID | S-006 |
+| ------------- | ----- |
+| ユースケース名 | 顧客情報更新 |
+| アクター | スタッフ |
+| 説明 | スタッフが既存の顧客情報を更新する |
+| 事前条件 | スタッフがログイン済み、顧客が登録済み |
+| 基本フロー | 1. 顧客詳細ページにアクセス<br>2. 編集ボタンをクリック<br>3. 顧客情報を編集<br>4. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | 顧客情報が更新される |
+
+### 3.3. プログラム管理
+
+| ユースケースID | S-007 |
+| ------------- | ----- |
+| ユースケース名 | プログラム作成 |
+| アクター | スタッフ |
+| 説明 | スタッフが新規プログラムを作成する |
+| 事前条件 | スタッフがログイン済み |
+| 基本フロー | 1. プログラム作成フォームにアクセス<br>2. プログラム詳細（タイトル、説明、日時、参加人数制限等）を入力<br>3. フォームを送信<br>4. システムがデータを検証<br>5. プログラム情報を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | 新規プログラムがシステムに登録される |
+
+| ユースケースID | S-008 |
+| ------------- | ----- |
+| ユースケース名 | プログラム更新 |
+| アクター | スタッフ |
+| 説明 | スタッフが既存のプログラム情報を更新する |
+| 事前条件 | スタッフがログイン済み、プログラムが登録済み |
+| 基本フロー | 1. プログラム詳細ページにアクセス<br>2. 編集ボタンをクリック<br>3. プログラム情報を編集<br>4. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す<br>- 既に予約がある場合: 特定の項目の編集を制限 |
+| 事後条件 | プログラム情報が更新される |
+
+| ユースケースID | S-009 |
+| ------------- | ----- |
+| ユースケース名 | プログラム参加者管理 |
+| アクター | スタッフ |
+| 説明 | スタッフがプログラムの参加者を管理する |
+| 事前条件 | スタッフがログイン済み、プログラムが登録済み |
+| 基本フロー | 1. プログラム詳細ページの参加者タブにアクセス<br>2. 参加者リストを確認<br>3. 参加承認または拒否の操作を行う |
+| 代替フロー | - 参加者なし: 参加者がいない旨のメッセージを表示 |
+| 事後条件 | 参加者のステータスが更新される |
+
+### 3.4. メッセージング
+
+| ユースケースID | S-010 |
+| ------------- | ----- |
+| ユースケース名 | 顧客へのメッセージ送信 |
+| アクター | スタッフ |
+| 説明 | スタッフが顧客にメッセージを送信する |
+| 事前条件 | スタッフがログイン済み、顧客が登録済み |
+| 基本フロー | 1. 顧客詳細ページのメッセージタブにアクセス<br>2. 新規メッセージボタンをクリック<br>3. メッセージのタイトルと本文を入力<br>4. タグを選択（オプション）<br>5. メッセージを送信 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | メッセージが顧客に送信される |
+
+| ユースケースID | S-011 |
+| ------------- | ----- |
+| ユースケース名 | 顧客からのメッセージ確認 |
+| アクター | スタッフ |
+| 説明 | スタッフが顧客からのメッセージを確認する |
+| 事前条件 | スタッフがログイン済み、顧客からメッセージが送信済み |
+| 基本フロー | 1. メッセージ一覧ページにアクセス<br>2. 未読または特定の顧客からのメッセージをフィルタ<br>3. メッセージを選択して詳細を閲覧 |
+| 代替フロー | - メッセージなし: メッセージがない旨のメッセージを表示 |
+| 事後条件 | メッセージが既読状態になる |
+
+| ユースケースID | S-012 |
+| ------------- | ----- |
+| ユースケース名 | メッセージ返信 |
+| アクター | スタッフ |
+| 説明 | スタッフが顧客のメッセージに返信する |
+| 事前条件 | スタッフがログイン済み、顧客からメッセージが送信済み |
+| 基本フロー | 1. メッセージ詳細画面にアクセス<br>2. 返信ボタンをクリック<br>3. 返信内容を入力<br>4. 返信を送信 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | 返信が顧客に送信される |
+
+## 4. 顧客のユースケース
+
+### 4.1. アカウント管理
+
+| ユースケースID | C-001 |
+| ------------- | ----- |
+| ユースケース名 | 顧客アカウント登録 |
+| アクター | 顧客 |
+| 説明 | 顧客が自らアカウントを登録する |
+| 事前条件 | なし |
+| 基本フロー | 1. 顧客がアカウント登録ページにアクセス<br>2. 基本情報を入力<br>3. メールアドレスとパスワードを設定<br>4. 登録を完了 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す<br>- メールアドレス重複: 既存アカウントを使用するよう促す |
+| 事後条件 | 新規顧客アカウントが作成される |
+
+| ユースケースID | C-002 |
+| ------------- | ----- |
+| ユースケース名 | 顧客ログイン |
+| アクター | 顧客 |
+| 説明 | 顧客がシステムにログインする |
+| 事前条件 | 顧客アカウントが作成済み |
+| 基本フロー | 1. 顧客がログインページにアクセス<br>2. メールアドレスとパスワードを入力<br>3. 認証情報を検証<br>4. マイページにリダイレクト |
+| 代替フロー | - 認証失敗: エラーメッセージを表示 |
+| 事後条件 | 顧客がログイン状態になる |
+
+| ユースケースID | C-003 |
+| ------------- | ----- |
+| ユースケース名 | 顧客ログアウト |
+| アクター | 顧客 |
+| 説明 | 顧客がシステムからログアウトする |
+| 事前条件 | 顧客がログイン済み |
+| 基本フロー | 1. 顧客がログアウトボタンをクリック<br>2. セッションを終了<br>3. ホームページにリダイレクト |
+| 代替フロー | なし |
+| 事後条件 | 顧客がログアウト状態になる |
+
+| ユースケースID | C-004 |
+| ------------- | ----- |
+| ユースケース名 | 顧客情報更新 |
+| アクター | 顧客 |
+| 説明 | 顧客が自身のアカウント情報を更新する |
+| 事前条件 | 顧客がログイン済み |
+| 基本フロー | 1. 顧客がマイページのアカウント設定にアクセス<br>2. 情報を編集<br>3. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | 顧客情報が更新される |
+
+### 4.2. プログラム参加
+
+| ユースケースID | C-005 |
+| ------------- | ----- |
+| ユースケース名 | プログラム閲覧 |
+| アクター | 顧客 |
+| 説明 | 顧客が利用可能なプログラムを閲覧する |
+| 事前条件 | 顧客がログイン済み（オプション） |
+| 基本フロー | 1. プログラム一覧ページにアクセス<br>2. プログラムをフィルタリング/ソート（オプション）<br>3. プログラム詳細を閲覧 |
+| 代替フロー | - プログラムなし: 利用可能なプログラムがない旨のメッセージを表示 |
+| 事後条件 | プログラム情報が表示される |
+
+| ユースケースID | C-006 |
+| ------------- | ----- |
+| ユースケース名 | プログラム予約 |
+| アクター | 顧客 |
+| 説明 | 顧客がプログラムを予約する |
+| 事前条件 | 顧客がログイン済み、予約可能なプログラムが存在する |
+| 基本フロー | 1. プログラム詳細ページにアクセス<br>2. 予約ボタンをクリック<br>3. 予約情報を入力/確認<br>4. 予約を確定 |
+| 代替フロー | - 定員超過: 予約できない旨のメッセージを表示<br>- 予約期間外: 予約できない旨のメッセージを表示 |
+| 事後条件 | プログラムが予約され、エントリーが作成される |
+
+| ユースケースID | C-007 |
+| ------------- | ----- |
+| ユースケース名 | 予約キャンセル |
+| アクター | 顧客 |
+| 説明 | 顧客が予約したプログラムをキャンセルする |
+| 事前条件 | 顧客がログイン済み、プログラムを予約済み |
+| 基本フロー | 1. マイページの予約一覧にアクセス<br>2. キャンセルするプログラムを選択<br>3. キャンセルボタンをクリック<br>4. キャンセルを確認 |
+| 代替フロー | - キャンセル期限超過: キャンセルできない旨のメッセージを表示 |
+| 事後条件 | 予約がキャンセルされる |
+
+### 4.3. メッセージング
+
+| ユースケースID | C-008 |
+| ------------- | ----- |
+| ユースケース名 | スタッフへのメッセージ送信 |
+| アクター | 顧客 |
+| 説明 | 顧客がスタッフにメッセージを送信する |
+| 事前条件 | 顧客がログイン済み |
+| 基本フロー | 1. マイページのメッセージ機能にアクセス<br>2. 新規メッセージボタンをクリック<br>3. メッセージのタイトルと本文を入力<br>4. 宛先のスタッフを選択またはカテゴリを選択<br>5. メッセージを送信 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | メッセージがスタッフに送信される |
+
+| ユースケースID | C-009 |
+| ------------- | ----- |
+| ユースケース名 | メッセージ履歴確認 |
+| アクター | 顧客 |
+| 説明 | 顧客が過去のメッセージのやり取りを確認する |
+| 事前条件 | 顧客がログイン済み、メッセージのやり取りが存在する |
+| 基本フロー | 1. マイページのメッセージ履歴にアクセス<br>2. メッセージスレッドを選択<br>3. やり取りの履歴を確認 |
+| 代替フロー | - メッセージなし: メッセージがない旨のメッセージを表示 |
+| 事後条件 | メッセージ履歴が表示される |
+
+## 5. 管理者のユースケース
+
+### 5.1. アカウント管理
+
+| ユースケースID | A-001 |
+| ------------- | ----- |
+| ユースケース名 | 管理者ログイン |
+| アクター | 管理者 |
+| 説明 | 管理者がシステムにログインする |
+| 事前条件 | 管理者アカウントが作成されている |
+| 基本フロー | 1. 管理者がログインページにアクセス<br>2. メールアドレスとパスワードを入力<br>3. 認証情報を検証<br>4. 管理者ダッシュボードにリダイレクト |
+| 代替フロー | - 認証失敗: エラーメッセージを表示 |
+| 事後条件 | 管理者がログイン状態になる |
+
+| ユースケースID | A-002 |
+| ------------- | ----- |
+| ユースケース名 | 管理者ログアウト |
+| アクター | 管理者 |
+| 説明 | 管理者がシステムからログアウトする |
+| 事前条件 | 管理者がログイン済み |
+| 基本フロー | 1. 管理者がログアウトボタンをクリック<br>2. セッションを終了<br>3. ログインページにリダイレクト |
+| 代替フロー | なし |
+| 事後条件 | 管理者がログアウト状態になる |
+
+### 5.2. スタッフ管理
+
+| ユースケースID | A-003 |
+| ------------- | ----- |
+| ユースケース名 | スタッフアカウント作成 |
+| アクター | 管理者 |
+| 説明 | 管理者が新規スタッフアカウントを作成する |
+| 事前条件 | 管理者がログイン済み |
+| 基本フロー | 1. スタッフ管理ページにアクセス<br>2. 新規スタッフ作成ボタンをクリック<br>3. スタッフ情報を入力<br>4. アカウントを作成 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す<br>- メールアドレス重複: エラーメッセージを表示 |
+| 事後条件 | 新規スタッフアカウントが作成される |
+
+| ユースケースID | A-004 |
+| ------------- | ----- |
+| ユースケース名 | スタッフアカウント編集 |
+| アクター | 管理者 |
+| 説明 | 管理者が既存のスタッフアカウント情報を編集する |
+| 事前条件 | 管理者がログイン済み、スタッフアカウントが存在する |
+| 基本フロー | 1. スタッフ一覧ページにアクセス<br>2. 編集するスタッフを選択<br>3. 編集ボタンをクリック<br>4. スタッフ情報を編集<br>5. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | スタッフ情報が更新される |
+
+| ユースケースID | A-005 |
+| ------------- | ----- |
+| ユースケース名 | スタッフアカウント停止/再開 |
+| アクター | 管理者 |
+| 説明 | 管理者がスタッフアカウントの停止または再開を行う |
+| 事前条件 | 管理者がログイン済み、スタッフアカウントが存在する |
+| 基本フロー | 1. スタッフ一覧ページにアクセス<br>2. 対象のスタッフを選択<br>3. 停止/再開ボタンをクリック<br>4. 確認ダイアログで確認 |
+| 代替フロー | なし |
+| 事後条件 | スタッフアカウントの状態が変更される |
+
+| ユースケースID | A-006 |
+| ------------- | ----- |
+| ユースケース名 | スタッフイベントログ確認 |
+| アクター | 管理者 |
+| 説明 | 管理者がスタッフのアクティビティログを確認する |
+| 事前条件 | 管理者がログイン済み、スタッフアカウントが存在する |
+| 基本フロー | 1. スタッフ詳細ページにアクセス<br>2. イベントログタブを選択<br>3. ログを閲覧 |
+| 代替フロー | - ログなし: ログがない旨のメッセージを表示 |
+| 事後条件 | スタッフのアクティビティログが表示される |
+
+### 5.3. システム管理
+
+| ユースケースID | A-007 |
+| ------------- | ----- |
+| ユースケース名 | システム設定管理 |
+| アクター | 管理者 |
+| 説明 | 管理者がシステム全体の設定を管理する |
+| 事前条件 | 管理者がログイン済み |
+| 基本フロー | 1. システム設定ページにアクセス<br>2. 設定項目を編集<br>3. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | システム設定が更新される |
+
+| ユースケースID | A-008 |
+| ------------- | ----- |
+| ユースケース名 | アクセス制限IPアドレス管理 |
+| アクター | 管理者 |
+| 説明 | 管理者がアクセス許可するIPアドレスを管理する |
+| 事前条件 | 管理者がログイン済み |
+| 基本フロー | 1. IPアドレス制限設定ページにアクセス<br>2. 許可するIPアドレスを追加/編集/削除<br>3. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | アクセス制限設定が更新される |
+
+| ユースケースID | A-009 |
+| ------------- | ----- |
+| ユースケース名 | タグ管理 |
+| アクター | 管理者 |
+| 説明 | 管理者がメッセージングで使用するタグを管理する |
+| 事前条件 | 管理者がログイン済み |
+| 基本フロー | 1. タグ管理ページにアクセス<br>2. タグを追加/編集/削除<br>3. 変更を保存 |
+| 代替フロー | - バリデーションエラー: エラーメッセージを表示し再編集を促す |
+| 事後条件 | タグ設定が更新される |
+
+## 6. システム間ユースケース
+
+| ユースケースID | SYS-001 |
+| ------------- | ----- |
+| ユースケース名 | 自動メール送信 |
+| アクター | システム |
+| 説明 | システムが特定のイベント発生時に自動的にメールを送信する |
+| 事前条件 | 対象イベントが発生している（予約完了、メッセージ受信など） |
+| 基本フロー | 1. イベント発生を検知<br>2. メールテンプレートを選択<br>3. 必要な情報を埋め込む<br>4. メールを送信 |
+| 代替フロー | - メール送信失敗: エラーをログに記録し再送を試みる |
+| 事後条件 | メールが送信される |
+
+| ユースケースID | SYS-002 |
+| ------------- | ----- |
+| ユースケース名 | プログラム開始通知 |
+| アクター | システム |
+| 説明 | システムがプログラム開始前に参加者に通知する |
+| 事前条件 | プログラムが登録済み、参加者が存在する |
+| 基本フロー | 1. スケジュールされたタイミングで通知処理を実行<br>2. 参加者リストを取得<br>3. 各参加者に通知を送信 |
+| 代替フロー | - 通知送信失敗: エラーをログに記録 |
+| 事後条件 | 参加者に通知が送信される |
+
+## 7. 非機能要件に関連するユースケース
+
+| ユースケースID | NF-001 |
+| ------------- | ----- |
+| ユースケース名 | システム監視 |
+| アクター | 管理者 |
+| 説明 | 管理者がシステムのパフォーマンスと健全性を監視する |
+| 事前条件 | 管理者がログイン済み |
+| 基本フロー | 1. システム監視ダッシュボードにアクセス<br>2. パフォーマンス指標を確認<br>3. エラーログを確認<br>4. 必要に応じて対応策を実施 |
+| 代替フロー | なし |
+| 事後条件 | システム状態が把握される |
+
+| ユースケースID | NF-002 |
+| ------------- | ----- |
+| ユースケース名 | データバックアップ |
+| アクター | システム |
+| 説明 | システムが定期的にデータのバックアップを実行する |
+| 事前条件 | バックアップスケジュールが設定されている |
+| 基本フロー | 1. スケジュールされたタイミングでバックアッププロセスを開始<br>2. データベースのバックアップを取得<br>3. バックアップファイルを保存<br>4. 古いバックアップファイルの整理 |
+| 代替フロー | - バックアップ失敗: エラーをログに記録し管理者に通知 |
+| 事後条件 | データバックアップが作成される |
+
+## 8. ユースケース関連図
+
+以下は、Baukis-Kaiシステムの主要なユースケースとアクター間の関係を示すUML図です。
+
+```plantuml
+@startuml "Baukis-Kai システムユースケース図"
+left to right direction
+skinparam backgroundColor white
+skinparam handwritten false
+skinparam defaultFontName "MS Gothic"
+skinparam usecase {
+  BackgroundColor white
+  BorderColor black
+  ArrowColor black
+  ActorBorderColor black
+  ActorFontColor black
+}
+
+actor "スタッフ" as Staff
+actor "顧客" as Customer
+actor "管理者" as Admin
+actor "システム" as System
+
+rectangle "スタッフのユースケース" {
+  usecase "スタッフログイン" as S001
+  usecase "スタッフログアウト" as S002
+  usecase "スタッフアカウント情報更新" as S003
+  usecase "顧客情報登録" as S004
+  usecase "顧客情報検索" as S005
+  usecase "顧客情報更新" as S006
+  usecase "プログラム作成" as S007
+  usecase "プログラム更新" as S008
+  usecase "プログラム参加者管理" as S009
+  usecase "顧客へのメッセージ送信" as S010
+  usecase "顧客からのメッセージ確認" as S011
+  usecase "メッセージ返信" as S012
+}
+
+rectangle "顧客のユースケース" {
+  usecase "顧客アカウント登録" as C001
+  usecase "顧客ログイン" as C002
+  usecase "顧客ログアウト" as C003
+  usecase "顧客情報更新" as C004
+  usecase "プログラム閲覧" as C005
+  usecase "プログラム予約" as C006
+  usecase "予約キャンセル" as C007
+  usecase "スタッフへのメッセージ送信" as C008
+  usecase "メッセージ履歴確認" as C009
+}
+
+rectangle "管理者のユースケース" {
+  usecase "管理者ログイン" as A001
+  usecase "管理者ログアウト" as A002
+  usecase "スタッフアカウント作成" as A003
+  usecase "スタッフアカウント編���" as A004
+  usecase "スタッフアカウント停止/再開" as A005
+  usecase "スタッフイベントログ確認" as A006
+  usecase "システム設定管理" as A007
+  usecase "アクセス制限IPアドレス管理" as A008
+  usecase "タグ管理" as A009
+}
+
+rectangle "システム間ユースケース" {
+  usecase "自動メール送信" as SYS001
+  usecase "プログラム開始通知" as SYS002
+}
+
+rectangle "非機能要件に関連するユースケース" {
+  usecase "システム監視" as NF001
+  usecase "データバックアップ" as NF002
+}
+
+Staff --> S001
+Staff --> S002
+Staff --> S003
+Staff --> S004
+Staff --> S005
+Staff --> S006
+Staff --> S007
+Staff --> S008
+Staff --> S009
+Staff --> S010
+Staff --> S011
+Staff --> S012
+
+Customer --> C001
+Customer --> C002
+Customer --> C003
+Customer --> C004
+Customer --> C005
+Customer --> C006
+Customer --> C007
+Customer --> C008
+Customer --> C009
+
+Admin --> A001
+Admin --> A002
+Admin --> A003
+Admin --> A004
+Admin --> A005
+Admin --> A006
+Admin --> A007
+Admin --> A008
+Admin --> A009
+Admin --> NF001
+
+System --> SYS001
+System --> SYS002
+System --> NF002
+
+S010 ..> C009 : <<extend>>
+S011 ..> C008 : <<extend>>
+S012 ..> C008 : <<extend>>
+
+C006 ..> C005 : <<include>>
+C007 ..> C006 : <<include>>
+@enduml
+```

```

## コミット: f6d663a

### メッセージ

```
build:レストア
```

### 変更されたファイル

- M	.devcontainer/devcontainer.json
- M	Dockerfile
- A	Dockerfile-base
- M	README.md
- M	docker-compose.yml

### 変更内容

```diff
commit f6d663a639d8545e7b41788280fa5da2561c8291
Author: k2works <kakimomokuri@gmail.com>
Date:   Thu Apr 24 17:13:56 2025 +0900

    build:レストア

diff --git a/.devcontainer/devcontainer.json b/.devcontainer/devcontainer.json
index 52f7251..55a3816 100644
--- a/.devcontainer/devcontainer.json
+++ b/.devcontainer/devcontainer.json
@@ -2,7 +2,6 @@
 // README at: https://github.com/devcontainers/templates/tree/main/src/docker-in-docker
 {
 	"name": "Docker in Docker",
-	// Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
 	"image": "baukis-kai",

 	"features": {
diff --git a/Dockerfile b/Dockerfile
index 91daa36..c68b6cd 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,90 +1,4 @@
-FROM ubuntu:18.04
-
-# Setup locale
-RUN \
-apt-get -yq update && \
-apt-get install -y language-pack-ja-base language-pack-ja
-RUN update-locale LANG=ja_JP.UTF-8 LANGUAGE=ja_JP:ja
-ENV LANG=ja_JP.UTF-8
-ENV LC_ALL=ja_JP.UTF-8
-ENV LC_CTYPE=ja_JP.UTF-8
-
-RUN apt-get update && \
-    apt-get install -y \
-           sudo \
-           build-essential \
-           zip \
-           unzip \
-           git \
-           curl \
-           wget \
-           git-core \
-           libssl-dev \
-           libqt4-dev \
-           libc6-dev \
-           automake \
-           libtool \
-           libyaml-dev \
-           zlib1g \
-           zlib1g-dev \
-           openssl \
-           libreadline-dev \
-           libxml2-dev \
-           libxslt1-dev \
-           libncurses5-dev \
-           pkg-config \
-           chrpath \
-           libfontconfig1-dev \
-           libxft-dev \
-           libpq-dev \
-           libsqlite3-dev \
-           libmysqlclient-dev \
-           default-mysql-client \
-           postgresql-client \
-           xvfb \
-           qtbase5-dev \
-           libqt5webkit5-dev \
-           libqtwebkit-dev \
-           xauth \
-           libcurl4-openssl-dev \
-           software-properties-common \
-           libffi-dev \
-           libgdbm5 \
-           libgdbm-dev \
-           libdb-dev \
-           lsof \
-           vim
-
-# Ruby
-ENV RUBY_VER 2.4.0
-ENV BUNDLER_VER 1.13.7
-RUN rm -rf ~/.rbenv
-RUN git clone https://github.com/sstephenson/rbenv ~/.rbenv
-RUN git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
-RUN ~/.rbenv/plugins/ruby-build/install.sh
-RUN echo 'export PATH="/$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
-RUN echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
-RUN . ~/.bash_profile && \
-         rbenv install $RUBY_VER  && \
-         rbenv global $RUBY_VER
-ENV PATH ~/.rbenv/shims:$PATH
-RUN ~/.rbenv/shims/gem install bundler:$BUNDLER_VER
-
-# Node
-ENV NODE_VER 16
-RUN curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash
-RUN . $HOME/.nvm/nvm.sh && \
-    nvm install $NODE_VER && \
-    nvm use $NODE_VER && \
-    node -v && npm -v && \
-    npm i -g yarn
-RUN apt install -y nodejs
-
-# Workaround for Ruby
-RUN apt-get install -y libmysqlclient-dev
-RUN ~/.rbenv/shims/gem install mysql2 -v '0.4.5' --source 'https://rubygems.org/'
-RUN apt-get install -y libssl1.0-dev
-RUN ~/.rbenv/shims/gem install puma -v '3.6.0' --source 'https://rubygems.org/'
+FROM baukis-kai

 # Bundle install
 WORKDIR /srv
@@ -92,4 +6,6 @@ COPY Gemfile /srv/Gemfile
 COPY Gemfile.lock /srv/Gemfile.lock
 RUN ~/.rbenv/shims/bundle install

-SHELL ["/bin/bash", "-c"]
\ No newline at end of file
+COPY . /srv
+
+CMD ["bash", "-c", "bundle exec rake assets:precompile && bundle exec rake db:migrate && bundle exec rails server -b 0.0.0.0"]
diff --git a/Dockerfile-base b/Dockerfile-base
new file mode 100644
index 0000000..91daa36
--- /dev/null
+++ b/Dockerfile-base
@@ -0,0 +1,95 @@
+FROM ubuntu:18.04
+
+# Setup locale
+RUN \
+apt-get -yq update && \
+apt-get install -y language-pack-ja-base language-pack-ja
+RUN update-locale LANG=ja_JP.UTF-8 LANGUAGE=ja_JP:ja
+ENV LANG=ja_JP.UTF-8
+ENV LC_ALL=ja_JP.UTF-8
+ENV LC_CTYPE=ja_JP.UTF-8
+
+RUN apt-get update && \
+    apt-get install -y \
+           sudo \
+           build-essential \
+           zip \
+           unzip \
+           git \
+           curl \
+           wget \
+           git-core \
+           libssl-dev \
+           libqt4-dev \
+           libc6-dev \
+           automake \
+           libtool \
+           libyaml-dev \
+           zlib1g \
+           zlib1g-dev \
+           openssl \
+           libreadline-dev \
+           libxml2-dev \
+           libxslt1-dev \
+           libncurses5-dev \
+           pkg-config \
+           chrpath \
+           libfontconfig1-dev \
+           libxft-dev \
+           libpq-dev \
+           libsqlite3-dev \
+           libmysqlclient-dev \
+           default-mysql-client \
+           postgresql-client \
+           xvfb \
+           qtbase5-dev \
+           libqt5webkit5-dev \
+           libqtwebkit-dev \
+           xauth \
+           libcurl4-openssl-dev \
+           software-properties-common \
+           libffi-dev \
+           libgdbm5 \
+           libgdbm-dev \
+           libdb-dev \
+           lsof \
+           vim
+
+# Ruby
+ENV RUBY_VER 2.4.0
+ENV BUNDLER_VER 1.13.7
+RUN rm -rf ~/.rbenv
+RUN git clone https://github.com/sstephenson/rbenv ~/.rbenv
+RUN git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
+RUN ~/.rbenv/plugins/ruby-build/install.sh
+RUN echo 'export PATH="/$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
+RUN echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
+RUN . ~/.bash_profile && \
+         rbenv install $RUBY_VER  && \
+         rbenv global $RUBY_VER
+ENV PATH ~/.rbenv/shims:$PATH
+RUN ~/.rbenv/shims/gem install bundler:$BUNDLER_VER
+
+# Node
+ENV NODE_VER 16
+RUN curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash
+RUN . $HOME/.nvm/nvm.sh && \
+    nvm install $NODE_VER && \
+    nvm use $NODE_VER && \
+    node -v && npm -v && \
+    npm i -g yarn
+RUN apt install -y nodejs
+
+# Workaround for Ruby
+RUN apt-get install -y libmysqlclient-dev
+RUN ~/.rbenv/shims/gem install mysql2 -v '0.4.5' --source 'https://rubygems.org/'
+RUN apt-get install -y libssl1.0-dev
+RUN ~/.rbenv/shims/gem install puma -v '3.6.0' --source 'https://rubygems.org/'
+
+# Bundle install
+WORKDIR /srv
+COPY Gemfile /srv/Gemfile
+COPY Gemfile.lock /srv/Gemfile.lock
+RUN ~/.rbenv/shims/bundle install
+
+SHELL ["/bin/bash", "-c"]
\ No newline at end of file
diff --git a/README.md b/README.md
index 20b3b14..8067995 100644
--- a/README.md
+++ b/README.md
@@ -42,16 +42,12 @@ Baukis 改
    1. [検索フォーム](#検索フォーム)

 ## アプリケーション環境構築
-### Vagarntのセットアップ
-```
-vagrant up
-vagrant ssh
-```

 ### Dockerのセットアップ
 ```
-cd /vagrant/
-docker-compose build
+docker build -t baukis-kai -f Dockerfile-base .
+docker compose build
+docker compose up -d
 ```

 ### 追加Gemセットアップ
diff --git a/docker-compose.yml b/docker-compose.yml
index f15c0d7..1c4c872 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -1,5 +1,18 @@
 version: '2'
 services:
+  app:
+    build:
+      context: .
+    depends_on:
+      - db
+    environment:
+      MYSQL_HOST: db
+      MYSQL_PORT: 3306
+      MYSQL_USER: user
+      MYSQL_PASSWORD: pass
+      MYSQL_DATABASE: app_development
+    ports:
+      - "3000:3000"
   db:
     image: mysql:5.7
     environment:
@@ -10,33 +23,11 @@ services:
       - 3306:3306
     volumes:
       - mysql-db:/var/lib/mysql
-  web:
-    build: .
-    environment:
-      - RAILS_ENV=production
-      - RAILS_SERVE_STATIC_FILES=public
-      - SECRET_KEY_BASE=8ea360b9c9f1fd8686e20bcf0e02ddcbcd78ad5984559739e04f343d79e44d3cecb09a2b930d0c78bfc5778026b7905a414222f43dd24db86fc076e43e4c35fa
-      - DATABASE_URL=db
-    command: bundle exec rails s -p 3000 -b '0.0.0.0'
-    volumes:
-      - .:/myapp
-    ports:
-      - "3000:3000"
-    depends_on:
-      - db
-  proxy:
-    image: nginx:1.11
-    ports:
-      - "80:80"
-    depends_on:
-      - web
-    volumes:
-      - ./nginx_default.conf:/etc/nginx/conf.d/default.conf

   console:
     build:
       context: .
-      dockerfile: ./Dockerfile
+      dockerfile: Dockerfile-base
     environment:
       MYSQL_HOST: db
       MYSQL_PORT: 3306

```

## コミット: 826251b

### メッセージ

```
build:ファイルの整理
```

### 変更されたファイル

- M	.gitignore
- D	.idea/.generators
- D	.idea/.rakeTasks
- D	.idea/misc.xml
- D	.idea/modules.xml
- D	.idea/vagrant.xml
- D	.idea/vcs.xml
- D	Jenkinsfile
- M	README.md
- D	Vagrantfile
- D	circle.yml

### 変更内容

```diff
commit 826251ba59558977a2b089cb862f1c21b7d57cbe
Author: k2works <kakimomokuri@gmail.com>
Date:   Thu Apr 24 16:35:17 2025 +0900

    build:ファイルの整理

diff --git a/.gitignore b/.gitignore
index 05ce7cf..40045d9 100644
--- a/.gitignore
+++ b/.gitignore
@@ -106,4 +106,6 @@ bower.json
 # Ignore Byebug command history file.
 .byebug_history

-public/assets/
\ No newline at end of file
+public/assets/
+.idea/
+*.iml
\ No newline at end of file
diff --git a/.idea/.generators b/.idea/.generators
deleted file mode 100644
index a68204b..0000000
--- a/.idea/.generators
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<Settings><!--This file was automatically generated by Ruby plugin.
-You are allowed to: 
-1. Reorder generators
-2. Remove generators
-3. Add installed generators
-To add new installed generators automatically delete this file and reload the project.
---><GeneratorsGroup><Generator name="annotate:install" /><Generator name="assets" /><Generator name="channel" /><Generator name="coffee:assets" /><Generator name="controller" /><Generator name="erd:install" /><Generator name="factory_girl:model" /><Generator name="generator" /><Generator name="helper" /><Generator name="i18n" /><Generator name="i18n_locale" /><Generator name="i18n_translation" /><Generator name="integration_test" /><Generator name="jbuilder" /><Generator name="job" /><Generator name="js:assets" /><Generator name="kaminari:config" /><Generator name="kaminari:views" /><Generator name="mailer" /><Generator name="migration" /><Generator name="model" /><Generator name="rack:dev-mark:install" /><Generator name="resource" /><Generator name="rspec:controller" /><Generator name="rspec:feature" /><Generator name="rspec:helper" /><Generator name="rspec:install" /><Generator name="rspec:integration" /><Generator name="rspec:job" /><Generator name="rspec:mailer" /><Generator name="rspec:model" /><Generator name="rspec:observer" /><Generator name="rspec:request" /><Generator name="rspec:scaffold" /><Generator name="rspec:view" /><Generator name="scaffold" /><Generator name="scaffold_controller" /><Generator name="task" /><Generator name="test_unit:controller" /><Generator name="test_unit:generator" /><Generator name="test_unit:helper" /><Generator name="test_unit:integration" /><Generator name="test_unit:job" /><Generator name="test_unit:mailer" /><Generator name="test_unit:model" /><Generator name="test_unit:plugin" /><Generator name="test_unit:scaffold" /></GeneratorsGroup></Settings>
diff --git a/.idea/.rakeTasks b/.idea/.rakeTasks
deleted file mode 100644
index 435f846..0000000
--- a/.idea/.rakeTasks
+++ /dev/null
@@ -1,7 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<Settings><!--This file was automatically generated by Ruby plugin.
-You are allowed to: 
-1. Remove rake task
-2. Add existing rake tasks
-To add existing rake tasks automatically delete this file and reload the project.
---><RakeGroup description="" fullCmd="" taksId="rake"><RakeTask description="List versions of all Rails frameworks and the environment" fullCmd="about" taksId="about" /><RakeTask description="Add schema information (as comments) to model and fixture files" fullCmd="annotate_models" taksId="annotate_models" /><RakeTask description="Adds the route map to routes.rb" fullCmd="annotate_routes" taksId="annotate_routes" /><RakeGroup description="" fullCmd="" taksId="app"><RakeTask description="Applies the template supplied by LOCATION=(/path/to/template) or URL" fullCmd="app:template" taksId="template" /><RakeTask description="Update configs and some other initially generated files (or use just update:configs or update:bin)" fullCmd="app:update" taksId="update" /><RakeGroup description="" fullCmd="" taksId="templates"><RakeTask description="" fullCmd="app:templates:copy" taksId="copy" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="update"><RakeTask description="" fullCmd="app:update:bin" taksId="bin" /><RakeTask description="" fullCmd="app:update:configs" taksId="configs" /><RakeTask description="" fullCmd="app:update:upgrade_guide_info" taksId="upgrade_guide_info" /></RakeGroup></RakeGroup><RakeGroup description="" fullCmd="" taksId="assets"><RakeTask description="Remove old compiled assets" fullCmd="assets:clean[keep]" taksId="clean[keep]" /><RakeTask description="Remove compiled assets" fullCmd="assets:clobber" taksId="clobber" /><RakeTask description="Load asset compile environment" fullCmd="assets:environment" taksId="environment" /><RakeTask description="Compile all the assets named in config.assets.precompile" fullCmd="assets:precompile" taksId="precompile" /><RakeTask description="" fullCmd="assets:clean" taksId="clean" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="cache_digests"><RakeTask description="Lookup first-level dependencies for TEMPLATE (like messages/show or comments/_comment.html)" fullCmd="cache_digests:dependencies" taksId="dependencies" /><RakeTask description="Lookup nested dependencies for TEMPLATE (like messages/show or comments/_comment.html)" fullCmd="cache_digests:nested_dependencies" taksId="nested_dependencies" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="db"><RakeTask description="Creates the database from DATABASE_URL or config/database.yml for the current RAILS_ENV (use db:create:all to create all databases in the config). Without RAILS_ENV or when RAILS_ENV is development, it defaults to creating the development and test databases" fullCmd="db:create" taksId="create" /><RakeTask description="Drops the database from DATABASE_URL or config/database.yml for the current RAILS_ENV (use db:drop:all to drop all databases in the config). Without RAILS_ENV or when RAILS_ENV is development, it defaults to dropping the development and test databases" fullCmd="db:drop" taksId="drop" /><RakeGroup description="" fullCmd="" taksId="environment"><RakeTask description="Set the environment value for the database" fullCmd="db:environment:set" taksId="set" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="fixtures"><RakeTask description="Loads fixtures into the current environment's database" fullCmd="db:fixtures:load" taksId="load" /><RakeTask description="" fullCmd="db:fixtures:identify" taksId="identify" /></RakeGroup><RakeTask description="Migrate the database (options: VERSION=x, VERBOSE=false, SCOPE=blog)" fullCmd="db:migrate" taksId="migrate" /><RakeGroup description="" fullCmd="" taksId="migrate"><RakeTask description="Display status of migrations" fullCmd="db:migrate:status" taksId="status" /><RakeTask description="" fullCmd="db:migrate:change" taksId="change" /><RakeTask description="" fullCmd="db:migrate:down" taksId="down" /><RakeTask description="" fullCmd="db:migrate:redo" taksId="redo" /><RakeTask description="" fullCmd="db:migrate:reset" taksId="reset" /><RakeTask description="" fullCmd="db:migrate:up" taksId="up" /></RakeGroup><RakeTask description="Rolls the schema back to the previous version (specify steps w/ STEP=n)" fullCmd="db:rollback" taksId="rollback" /><RakeGroup description="" fullCmd="" taksId="schema"><RakeGroup description="" fullCmd="" taksId="cache"><RakeTask description="Clears a db/schema_cache.dump file" fullCmd="db:schema:cache:clear" taksId="clear" /><RakeTask description="Creates a db/schema_cache.dump file" fullCmd="db:schema:cache:dump" taksId="dump" /></RakeGroup><RakeTask description="Creates a db/schema.rb file that is portable against any DB supported by Active Record" fullCmd="db:schema:dump" taksId="dump" /><RakeTask description="Loads a schema.rb file into the database" fullCmd="db:schema:load" taksId="load" /><RakeTask description="" fullCmd="db:schema:load_if_ruby" taksId="load_if_ruby" /></RakeGroup><RakeTask description="Loads the seed data from db/seeds.rb" fullCmd="db:seed" taksId="seed" /><RakeTask description="Creates the database, loads the schema, and initializes with the seed data (use db:reset to also drop the database first)" fullCmd="db:setup" taksId="setup" /><RakeGroup description="" fullCmd="" taksId="structure"><RakeTask description="Dumps the database structure to db/structure.sql" fullCmd="db:structure:dump" taksId="dump" /><RakeTask description="Recreates the databases from the structure.sql file" fullCmd="db:structure:load" taksId="load" /><RakeTask description="" fullCmd="db:structure:load_if_sql" taksId="load_if_sql" /></RakeGroup><RakeTask description="Retrieves the current schema version number" fullCmd="db:version" taksId="version" /><RakeTask description="" fullCmd="db:_dump" taksId="_dump" /><RakeTask description="" fullCmd="db:abort_if_pending_migrations" taksId="abort_if_pending_migrations" /><RakeTask description="" fullCmd="db:charset" taksId="charset" /><RakeTask description="" fullCmd="db:check_protected_environments" taksId="check_protected_environments" /><RakeTask description="" fullCmd="db:collation" taksId="collation" /><RakeGroup description="" fullCmd="" taksId="create"><RakeTask description="" fullCmd="db:create:all" taksId="all" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="drop"><RakeTask description="" fullCmd="db:drop:_unsafe" taksId="_unsafe" /><RakeTask description="" fullCmd="db:drop:all" taksId="all" /></RakeGroup><RakeTask description="" fullCmd="db:forward" taksId="forward" /><RakeTask description="" fullCmd="db:load_config" taksId="load_config" /><RakeTask description="" fullCmd="db:purge" taksId="purge" /><RakeGroup description="" fullCmd="" taksId="purge"><RakeTask description="" fullCmd="db:purge:all" taksId="all" /></RakeGroup><RakeTask description="" fullCmd="db:reset" taksId="reset" /><RakeGroup description="" fullCmd="" taksId="test"><RakeTask description="" fullCmd="db:test:clone" taksId="clone" /><RakeTask description="" fullCmd="db:test:clone_schema" taksId="clone_schema" /><RakeTask description="" fullCmd="db:test:clone_structure" taksId="clone_structure" /><RakeTask description="" fullCmd="db:test:deprecated" taksId="deprecated" /><RakeTask description="" fullCmd="db:test:load" taksId="load" /><RakeTask description="" fullCmd="db:test:load_schema" taksId="load_schema" /><RakeTask description="" fullCmd="db:test:load_structure" taksId="load_structure" /><RakeTask description="" fullCmd="db:test:prepare" taksId="prepare" /><RakeTask description="" fullCmd="db:test:purge" taksId="purge" /></RakeGroup></RakeGroup><RakeGroup description="" fullCmd="" taksId="dev"><RakeTask description="Toggle development mode caching on/off" fullCmd="dev:cache" taksId="cache" /></RakeGroup><RakeTask description="Generate an Entity-Relationship Diagram based on your models" fullCmd="erd" taksId="erd" /><RakeTask description="Print out all defined initializers in the order they are invoked by Rails" fullCmd="initializers" taksId="initializers" /><RakeGroup description="" fullCmd="" taksId="log"><RakeTask description="Truncates all/specified *.log files in log/ to zero bytes (specify which logs with LOGS=test,development)" fullCmd="log:clear" taksId="clear" /></RakeGroup><RakeTask description="Prints out your Rack middleware stack" fullCmd="middleware" taksId="middleware" /><RakeTask description="Enumerate all annotations (use notes:optimize, :fixme, :todo for focus)" fullCmd="notes" taksId="notes" /><RakeGroup description="" fullCmd="" taksId="notes"><RakeTask description="Enumerate a custom annotation, specify with ANNOTATION=CUSTOM" fullCmd="notes:custom" taksId="custom" /><RakeTask description="" fullCmd="notes:fixme" taksId="fixme" /><RakeTask description="" fullCmd="notes:optimize" taksId="optimize" /><RakeTask description="" fullCmd="notes:todo" taksId="todo" /></RakeGroup><RakeTask description="Remove schema information from model and fixture files" fullCmd="remove_annotation" taksId="remove_annotation" /><RakeTask description="Removes the route map from routes.rb" fullCmd="remove_routes" taksId="remove_routes" /><RakeTask description="Restart app by touching tmp/restart.txt" fullCmd="restart" taksId="restart" /><RakeTask description="Print out all defined routes in match order, with names" fullCmd="routes" taksId="routes" /><RakeTask description="Generate a cryptographically secure secret key (this is typically used to generate a secret for cookie sessions)" fullCmd="secret" taksId="secret" /><RakeTask description="Run all specs in spec directory (excluding plugin specs)" fullCmd="spec" taksId="spec" /><RakeGroup description="" fullCmd="" taksId="spec"><RakeTask description="Run the code examples in spec/controllers" fullCmd="spec:controllers" taksId="controllers" /><RakeTask description="Run the code examples in spec/features" fullCmd="spec:features" taksId="features" /><RakeTask description="Run the code examples in spec/models" fullCmd="spec:models" taksId="models" /><RakeTask description="Run the code examples in spec/routing" fullCmd="spec:routing" taksId="routing" /><RakeTask description="Run the code examples in spec/services" fullCmd="spec:services" taksId="services" /><RakeTask description="" fullCmd="spec:prepare" taksId="prepare" /><RakeTask description="" fullCmd="spec:statsetup" taksId="statsetup" /></RakeGroup><RakeTask description="Report code statistics (KLOCs, etc) from the application or engine" fullCmd="stats" taksId="stats" /><RakeTask description="Runs all tests in test folder" fullCmd="test" taksId="test" /><RakeGroup description="" fullCmd="" taksId="test"><RakeTask description="Run tests quickly, but also reset db" fullCmd="test:db" taksId="db" /><RakeTask description="" fullCmd="test:controllers" taksId="controllers" /><RakeTask description="" fullCmd="test:functionals" taksId="functionals" /><RakeTask description="" fullCmd="test:generators" taksId="generators" /><RakeTask description="" fullCmd="test:helpers" taksId="helpers" /><RakeTask description="" fullCmd="test:integration" taksId="integration" /><RakeTask description="" fullCmd="test:jobs" taksId="jobs" /><RakeTask description="" fullCmd="test:mailers" taksId="mailers" /><RakeTask description="" fullCmd="test:models" taksId="models" /><RakeTask description="" fullCmd="test:prepare" taksId="prepare" /><RakeTask description="" fullCmd="test:run" taksId="run" /><RakeTask description="" fullCmd="test:units" taksId="units" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="time"><RakeTask description="List all time zones, list by two-letter country code (`rails time:zones[US]`), or list by UTC offset (`rails time:zones[-8]`)" fullCmd="time:zones[country_or_offset]" taksId="zones[country_or_offset]" /><RakeTask description="" fullCmd="time:zones" taksId="zones" /><RakeGroup description="" fullCmd="" taksId="zones"><RakeTask description="" fullCmd="time:zones:all" taksId="all" /><RakeTask description="" fullCmd="time:zones:local" taksId="local" /><RakeTask description="" fullCmd="time:zones:us" taksId="us" /></RakeGroup></RakeGroup><RakeGroup description="" fullCmd="" taksId="tmp"><RakeTask description="Clear cache and socket files from tmp/ (narrow w/ tmp:cache:clear, tmp:sockets:clear)" fullCmd="tmp:clear" taksId="clear" /><RakeTask description="Creates tmp directories for cache, sockets, and pids" fullCmd="tmp:create" taksId="create" /><RakeGroup description="" fullCmd="" taksId="cache"><RakeTask description="" fullCmd="tmp:cache:clear" taksId="clear" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="pids"><RakeTask description="" fullCmd="tmp:pids:clear" taksId="clear" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="sockets"><RakeTask description="" fullCmd="tmp:sockets:clear" taksId="clear" /></RakeGroup></RakeGroup><RakeTask description="" fullCmd="default" taksId="default" /><RakeTask description="" fullCmd="environment" taksId="environment" /><RakeGroup description="" fullCmd="" taksId="erd"><RakeTask description="" fullCmd="erd:generate" taksId="generate" /><RakeTask description="" fullCmd="erd:load_models" taksId="load_models" /><RakeTask description="" fullCmd="erd:options" taksId="options" /></RakeGroup><RakeGroup description="" fullCmd="" taksId="rails"><RakeTask description="" fullCmd="rails:template" taksId="template" /><RakeGroup description="" fullCmd="" taksId="templates"><RakeTask description="" fullCmd="rails:templates:copy" taksId="copy" /></RakeGroup><RakeTask description="" fullCmd="rails:update" taksId="update" /><RakeGroup description="" fullCmd="" taksId="update"><RakeTask description="" fullCmd="rails:update:bin" taksId="bin" /><RakeTask description="" fullCmd="rails:update:configs" taksId="configs" /></RakeGroup></RakeGroup><RakeGroup description="" fullCmd="" taksId="railties"><RakeGroup description="" fullCmd="" taksId="install"><RakeTask description="" fullCmd="railties:install:migrations" taksId="migrations" /></RakeGroup></RakeGroup><RakeTask description="" fullCmd="set_annotation_options" taksId="set_annotation_options" /><RakeTask description="" fullCmd="tmp" taksId="tmp" /><RakeTask description="" fullCmd="tmp/cache" taksId="tmp/cache" /><RakeTask description="" fullCmd="tmp/cache/assets" taksId="tmp/cache/assets" /><RakeTask description="" fullCmd="tmp/pids" taksId="tmp/pids" /><RakeTask description="" fullCmd="tmp/sockets" taksId="tmp/sockets" /></RakeGroup></Settings>
diff --git a/.idea/misc.xml b/.idea/misc.xml
deleted file mode 100644
index 5e26784..0000000
--- a/.idea/misc.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_1_3" default="false" project-jdk-name="rbenv: 2.4.0" project-jdk-type="RUBY_SDK">
-    <output url="file://$PROJECT_DIR$/out" />
-  </component>
-</project>
\ No newline at end of file
diff --git a/.idea/modules.xml b/.idea/modules.xml
deleted file mode 100644
index 1f69da7..0000000
--- a/.idea/modules.xml
+++ /dev/null
@@ -1,8 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="ProjectModuleManager">
-    <modules>
-      <module fileurl="file://$PROJECT_DIR$/baukis-kai.iml" filepath="$PROJECT_DIR$/baukis-kai.iml" />
-    </modules>
-  </component>
-</project>
\ No newline at end of file
diff --git a/.idea/vagrant.xml b/.idea/vagrant.xml
deleted file mode 100644
index c6e2d31..0000000
--- a/.idea/vagrant.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="VagrantProjectSettings">
-    <option name="instanceFolder" value="$PROJECT_DIR$" />
-  </component>
-</project>
\ No newline at end of file
diff --git a/.idea/vcs.xml b/.idea/vcs.xml
deleted file mode 100644
index 35eb1dd..0000000
--- a/.idea/vcs.xml
+++ /dev/null
@@ -1,6 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<project version="4">
-  <component name="VcsDirectoryMappings">
-    <mapping directory="" vcs="Git" />
-  </component>
-</project>
\ No newline at end of file
diff --git a/Jenkinsfile b/Jenkinsfile
deleted file mode 100644
index 098e206..0000000
--- a/Jenkinsfile
+++ /dev/null
@@ -1,24 +0,0 @@
-node('master') {
-
-  stage 'Checkout'
-  git url: 'https://github.com/k2works/baukis-kai.git'
-
-  stage 'Prepare'
-  env.PATH = '/usr/local/bin:$HOME/.rbenv/shims:$HOME/.rbenv/bin:$PATH'
-  sh 'eval "$(rbenv init -)"'
-  sh 'rbenv local 2.4.0'
-
-  stage 'Prepare test'
-  sh "bundle install"
-  sh "bundle exec rake db:migrate"
-  sh "bundle exec rake db:test:prepare"
-
-  stage "Unit test"
-  sh "bundle exec rspec spec/controllers/*_spec.rb"
-  sh "bundle exec rspec spec/models/*_spec.rb"
-  sh "bundle exec rspec spec/routing/*_spec.rb"
-  sh "bundle exec rspec spec/services/*_spec.rb"
-
-  stage "Integration test"
-  sh "bundle exec rspec spec/features/*_spec.rb"
-}
diff --git a/README.md b/README.md
index 14a6731..20b3b14 100644
--- a/README.md
+++ b/README.md
@@ -10,7 +10,6 @@ Baukis 改
 |:---------------|:-------------|:------------|
 | ruby           |2.4.0    |             |
 | rails          |5.0.1    |             |
-| vagrant        |1.8.7    |             |
 | docker         |1.12.5    |             |
 | docker-compose |1.8.0    |             |

diff --git a/Vagrantfile b/Vagrantfile
deleted file mode 100644
index b27838b..0000000
--- a/Vagrantfile
+++ /dev/null
@@ -1,27 +0,0 @@
-# -*- mode: ruby -*-
-# vi: set ft=ruby :
-
-Vagrant.configure("2") do |config|
-  config.vm.box = "hiroshima-arc/manhattan"
-  config.vm.box_version = "1.0.0"
-
-  config.vm.network :forwarded_port, guest:80, host:8888, id:"nginx"
-  config.vm.network :forwarded_port, guest:3000, host:3000, id:"rails"
-  config.vm.network :forwarded_port, guest:3306, host:3306, id:"mysql"
-  config.vm.network :forwarded_port, guest:5432, host:5432, id:"postgresql"
-  config.vm.network :forwarded_port, guest:6379, host:6379, id:"redis"
-  config.vm.network :forwarded_port, guest:27017, host:27017, id:"mongodb"
-  config.vm.network :forwarded_port, guest:8080, host:8080, id:"jenkins"
-  config.vm.network :private_network, ip:"127.0.0.1"
-
-  config.vm.synced_folder ".", "/vagrant", mount_options: ['dmode=777','fmode=777']
-
-  config.vm.provider "virtualbox" do |vb|
-    vb.gui = false
-
-    # Use VBoxManage to customize the VM. For example to change memory:
-    vb.customize ["modifyvm", :id, "--memory", "4096"]
-    vb.customize ["modifyvm", :id, "--vram", "128"]
-    vb.customize ["modifyvm", :id, "--accelerate3d", "on"]
-  end
-end
\ No newline at end of file
diff --git a/circle.yml b/circle.yml
deleted file mode 100644
index 150a280..0000000
--- a/circle.yml
+++ /dev/null
@@ -1,5 +0,0 @@
-deployment:
-  staging:
-    branch: master
-    heroku:
-      appname: baukis-kai
\ No newline at end of file

```

## コミット: 835dfd2

### メッセージ

```
build:devcontainerセットアップ
```

### 変更されたファイル

- A	.devcontainer/devcontainer.json

### 変更内容

```diff
commit 835dfd2f8375a81df83e71c3b6b91ffbd65b6448
Author: k2works <kakimomokuri@gmail.com>
Date:   Thu Apr 24 16:29:16 2025 +0900

    build:devcontainerセットアップ

diff --git a/.devcontainer/devcontainer.json b/.devcontainer/devcontainer.json
new file mode 100644
index 0000000..52f7251
--- /dev/null
+++ b/.devcontainer/devcontainer.json
@@ -0,0 +1,31 @@
+// For format details, see https://aka.ms/devcontainer.json. For config options, see the
+// README at: https://github.com/devcontainers/templates/tree/main/src/docker-in-docker
+{
+	"name": "Docker in Docker",
+	// Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
+	"image": "baukis-kai",
+
+	"features": {
+		"ghcr.io/devcontainers/features/docker-in-docker:2": {
+			"version": "latest",
+			"enableNonRootDocker": "true",
+			"moby": "true"
+		}
+	},
+
+	// Use 'forwardPorts' to make a list of ports inside the container available locally.
+	// "forwardPorts": [],
+
+	// Use 'postCreateCommand' to run commands after the container is created.
+	// "postCreateCommand": "docker --version",
+
+	// Configure tool-specific properties.
+  "customizations" : {
+    "jetbrains" : {
+      "backend" : "IntelliJ"
+    }
+  },
+
+	// Uncomment to connect as root instead. More info: https://aka.ms/dev-containers-non-root.
+	// "remoteUser": "root"
+}

```

## コミット: 5517d0b

### メッセージ

```
build:レストア
```

### 変更されたファイル

- M	Dockerfile
- M	Gemfile
- M	Gemfile.lock
- M	config/database.yml
- M	config/environments/development.rb
- M	docker-compose.yml

### 変更内容

```diff
commit 5517d0b74d777666bfef08aad9a3a87b14bf6c0e
Author: k2works <kakimomokuri@gmail.com>
Date:   Thu Apr 24 16:00:48 2025 +0900

    build:レストア

diff --git a/Dockerfile b/Dockerfile
index de3b64d..91daa36 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,9 +1,95 @@
-FROM ruby:2.4
-
-RUN apt-get update -qq && apt-get install -y build-essential libpq-dev nodejs
-RUN mkdir /myapp
-WORKDIR /myapp
-ADD Gemfile /myapp/Gemfile
-ADD Gemfile.lock /myapp/Gemfile.lock
-RUN bundle install
-ADD . /myapp
\ No newline at end of file
+FROM ubuntu:18.04
+
+# Setup locale
+RUN \
+apt-get -yq update && \
+apt-get install -y language-pack-ja-base language-pack-ja
+RUN update-locale LANG=ja_JP.UTF-8 LANGUAGE=ja_JP:ja
+ENV LANG=ja_JP.UTF-8
+ENV LC_ALL=ja_JP.UTF-8
+ENV LC_CTYPE=ja_JP.UTF-8
+
+RUN apt-get update && \
+    apt-get install -y \
+           sudo \
+           build-essential \
+           zip \
+           unzip \
+           git \
+           curl \
+           wget \
+           git-core \
+           libssl-dev \
+           libqt4-dev \
+           libc6-dev \
+           automake \
+           libtool \
+           libyaml-dev \
+           zlib1g \
+           zlib1g-dev \
+           openssl \
+           libreadline-dev \
+           libxml2-dev \
+           libxslt1-dev \
+           libncurses5-dev \
+           pkg-config \
+           chrpath \
+           libfontconfig1-dev \
+           libxft-dev \
+           libpq-dev \
+           libsqlite3-dev \
+           libmysqlclient-dev \
+           default-mysql-client \
+           postgresql-client \
+           xvfb \
+           qtbase5-dev \
+           libqt5webkit5-dev \
+           libqtwebkit-dev \
+           xauth \
+           libcurl4-openssl-dev \
+           software-properties-common \
+           libffi-dev \
+           libgdbm5 \
+           libgdbm-dev \
+           libdb-dev \
+           lsof \
+           vim
+
+# Ruby
+ENV RUBY_VER 2.4.0
+ENV BUNDLER_VER 1.13.7
+RUN rm -rf ~/.rbenv
+RUN git clone https://github.com/sstephenson/rbenv ~/.rbenv
+RUN git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
+RUN ~/.rbenv/plugins/ruby-build/install.sh
+RUN echo 'export PATH="/$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
+RUN echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
+RUN . ~/.bash_profile && \
+         rbenv install $RUBY_VER  && \
+         rbenv global $RUBY_VER
+ENV PATH ~/.rbenv/shims:$PATH
+RUN ~/.rbenv/shims/gem install bundler:$BUNDLER_VER
+
+# Node
+ENV NODE_VER 16
+RUN curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash
+RUN . $HOME/.nvm/nvm.sh && \
+    nvm install $NODE_VER && \
+    nvm use $NODE_VER && \
+    node -v && npm -v && \
+    npm i -g yarn
+RUN apt install -y nodejs
+
+# Workaround for Ruby
+RUN apt-get install -y libmysqlclient-dev
+RUN ~/.rbenv/shims/gem install mysql2 -v '0.4.5' --source 'https://rubygems.org/'
+RUN apt-get install -y libssl1.0-dev
+RUN ~/.rbenv/shims/gem install puma -v '3.6.0' --source 'https://rubygems.org/'
+
+# Bundle install
+WORKDIR /srv
+COPY Gemfile /srv/Gemfile
+COPY Gemfile.lock /srv/Gemfile.lock
+RUN ~/.rbenv/shims/bundle install
+
+SHELL ["/bin/bash", "-c"]
\ No newline at end of file
diff --git a/Gemfile b/Gemfile
index 7d8acb2..40c2377 100644
--- a/Gemfile
+++ b/Gemfile
@@ -79,7 +79,7 @@ group :test do
 end

 # Windows does not include zoneinfo files, so bundle the tzinfo-data gem
-gem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]
+gem 'tzinfo-data'

 gem 'font-awesome-rails'
 gem 'rails_12factor', group: :production
@@ -94,5 +94,4 @@ gem 'email_validator', '~> 1.6'
 gem 'jquery-ui-rails', '~> 5.0', '>= 5.0.5'
 gem 'momentjs-rails'
 gem 'bootstrap3-datetimepicker-rails'
-gem 'tag-it-rails'
-
+gem 'tag-it-rails'
\ No newline at end of file
diff --git a/Gemfile.lock b/Gemfile.lock
index ac11a7f..600d0fd 100644
--- a/Gemfile.lock
+++ b/Gemfile.lock
@@ -297,6 +297,8 @@ GEM
     turbolinks-source (5.0.0)
     tzinfo (1.2.2)
       thread_safe (~> 0.1)
+    tzinfo-data (1.2025.2)
+      tzinfo (>= 1.0.0)
     uglifier (3.0.4)
       execjs (>= 0.3.0, < 3)
     web-console (3.4.0)
diff --git a/config/database.yml b/config/database.yml
index 544640b..c44d192 100644
--- a/config/database.yml
+++ b/config/database.yml
@@ -16,7 +16,7 @@ default: &default
   pool: 5
   username: root
   password: password
-  host: 127.0.0.1
+  host: <%= ENV.fetch("MYSQL_HOST", "127.0.0.1") %>

 development:
   <<: *default
diff --git a/config/environments/development.rb b/config/environments/development.rb
index 63bc608..cfacff4 100644
--- a/config/environments/development.rb
+++ b/config/environments/development.rb
@@ -53,9 +53,9 @@ Rails.application.configure do
   config.file_watcher = ActiveSupport::EventedFileUpdateChecker

   config.baukis_kai = {
-      staff: { host: '0.0.0.0', path: 'staff' },
-      admin: { host: '0.0.0.0', path: 'admin' },
-      customer: { host: '0.0.0.0', path: '' },
+      staff: { host: '127.0.0.1', path: 'staff' },
+      admin: { host: '127.0.0.1', path: 'admin' },
+      customer: { host: '127.0.0.1', path: '' },
       restrict_ip_addresses: false
   }

diff --git a/docker-compose.yml b/docker-compose.yml
index 52da61d..f15c0d7 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -1,7 +1,15 @@
 version: '2'
 services:
   db:
-    image: mysql
+    image: mysql:5.7
+    environment:
+      MYSQL_ROOT_PASSWORD: password
+      MYSQL_USER: user
+      MYSQL_PASSWORD: pass
+    ports:
+      - 3306:3306
+    volumes:
+      - mysql-db:/var/lib/mysql
   web:
     build: .
     environment:
@@ -23,4 +31,24 @@ services:
     depends_on:
       - web
     volumes:
-      - ./nginx_default.conf:/etc/nginx/conf.d/default.conf
\ No newline at end of file
+      - ./nginx_default.conf:/etc/nginx/conf.d/default.conf
+
+  console:
+    build:
+      context: .
+      dockerfile: ./Dockerfile
+    environment:
+      MYSQL_HOST: db
+      MYSQL_PORT: 3306
+      MYSQL_USER: user
+      MYSQL_PASSWORD: pass
+      MYSQL_DATABASE: app_development
+    volumes:
+      - .:/srv
+    depends_on:
+      - db
+    stdin_open: true
+
+volumes:
+  mysql-db:
+    driver: local

```
